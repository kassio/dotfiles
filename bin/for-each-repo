#!/usr/bin/env bash

pushd "${PWD}" > /dev/null && trap 'popd &> /dev/null' EXIT HUP INT QUIT TERM

if [ "$1" = "-p" ]
then
  shift
  repos=$1
  shift
else
  repos=${REPOS}
fi

IFS=:
paths=(${repos})

for project in ${paths[@]}
do
  pushd ${project} &>/dev/null

  if [ -d ".git" ]
  then
    eval "$@"
  fi

  popd &>/dev/null
done
