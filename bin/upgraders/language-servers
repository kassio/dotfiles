#!/usr/bin/env zsh

if [ "${1}" = "-h" ] || [ "${1}" = "--help" ]; then
  echo "[language servers] update language servers dependencies"
  exit
fi

title "[language servers] update language servers dependencies"

subtitle "homebrew dependencies"
brew_dependencies=(
 "bash-language-server" # lsp server bash
 "efm-langserver" # lsp server generic
 "lua-language-server" # lsp server lua
 "sql-language-server" # lsp server sql
 "vscode-langservers-extracted" # lsp server html/css/json/eslint
 "yaml-language-server" # lsp server yaml
)
brew install --quiet "${brew_dependencies[@]}"

subtitle "go dependencies"
go_dependencies=(
  "golang.org/x/tools/gopls@latest" # lsp server
  "github.com/grafana/jsonnet-language-server@latest" # lsp server jsonnet
  "github.com/wader/jq-lsp@master" # lsp server jq
  "github.com/mrtazz/checkmake/cmd/checkmake@latest" # linter makefile
)
for dependency in "${go_dependencies[@]}"; do
  go install "${dependency}"
done

subtitle "ruby dependencies"
ruby_dependencies=(
  "rubocop" # linting
  "ruby_ls" # main ruby language server
)
for-each-asdf ruby gem install "${ruby_dependencies[@]}"

subtitle "node dependencies"
npm -g install sql-formatter
