#!/bin/bash

old_path="$PWD"
cd $HOME

link_files() {
  local file_path="$HOME/.dotfiles/dotfiles"

  for f in `ls -1 $file_path`
  do
    ln -sf "$file_path/$f" $HOME/.$f
  done
}; link_files

osx_setup() {
  if [[ "Darwin" == "$(uname)" ]]
  then
    $HOME/.dotfiles/bin/setup_osx
  fi
}; osx_setup

zsh_setup() {
  local zsh_path=$(which zsh)

  if [ -z "$(grep $zsh_path /etc/shells)" ]
  then
    echo $zsh_path | sudo tee -a /etc/shells
  fi

  if [ -e "/etc/zshenv" ]
  then
    sudo mv /etc/{zshenv,zshrc}
  fi
}; zsh_setup

update-git-prompt

if [ -e "$HOME/.zshrc" ]
then
  source $HOME/.zshrc &>/dev/null
else
  source $HOME/.bashrc &>/dev/null
fi

cd $old_path
