#!/bin/bash

cd $HOME

link_files() {
  local file_path="$HOME/.dotfiles/dotfiles"

  for f in `ls -1 $file_path`
  do
    ln -sf "$file_path/$f" $HOME/.$f
  done
}; link_files

if [[ -e "$HOME/.zshrc" ]]
then
  source $HOME/.zshrc &>/dev/null
fi

if [[ $(uname) == 'Darwin' ]]
then
  $HOME/.dotfiles/bin/setup_osx

  zsh_path=$(which zsh)
  if [ -z "$(grep $zsh_path /etc/shells)" ]
  then
    echo $zsh_path | sudo tee -a /etc/shells
  fi

  if [[ -e "/etc/zshenv" ]]
  then
    sudo mv /etc/{zshenv,zshrc}
  fi
fi

# load/update git-prompt.sh
curl \
  https://raw.githubusercontent.com/git/git/master/contrib/completion/git-prompt.sh \
  > $HOME/.dotfiles/lib/git-prompt.sh

cd $HOME
