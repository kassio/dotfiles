#!/usr/bin/env bash

title() {
  local blue='\e[0;36m'
  local yellow='\e[0;93m'
  local reset='\e[00m'
  local bullet="${yellow} â–¸ "

  printf "${bullet}${blue}$*${reset}\n"
}

print-help() {
  echo -e "usage: upgrade [-g|--git] [--no-git] [-h|--help]
  Upgrade your system
  Options:
  -g, --git      Update your git repositories in the \$REPOS, default.
  -G -no--git    Do not update your git repositories
  -h, --help     show this help message
"
}

git=true

for option in $@
do
  case $option in
    -G|--no-git)
      git=false
      ;;
    -g|--git)
      git=true
      ;;
    -h|--help)
      print-help
      exit 0
      ;;
  esac
done

if [ "$git" == true ]
then
  title "updating repositories"
  update-repos
fi

title "Apple upgrade"
softwareupdate -ia

title "brew upgrade"
brew update
brew upgrade --fetch-HEAD
brew cleanup

title "atom packages upgrade"
apm ls --installed --enabled --bare | sed 's/@.*//' > ${HOME}/.dotfiles/install/atom-packages
apm upgrade

title "neovim/vim packages upgrade"
${HOME}/.config/nvim/bin/pack

echo
