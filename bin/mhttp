#!/usr/bin/env ruby
# frozen_string_literal: true

require "bundler/inline"

gemfile do
  source "https://rubygems.org"

  gem "rack"
  gem "webrick"
end

require "rack"
require "webrick/httputils"

class Application
  def call(env)
    filename = env["PATH_INFO"].delete("/")

    body = if filename.empty?
             ["You must informat a filename to be read from /tmp"]
           else
             File.readlines(File.join("/tmp", filename))
           end
    puts '-' * 80
    p body
    puts '-' * 80

    [
      200,
      { "Content-Type" => "text/html" },
      body
    ]
  end
end

Rack::Server.start(app: Application.new)
